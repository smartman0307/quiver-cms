<div class="column small-12">
    <h3 class="font-flair">Discounts</h3>
    <form name="newDiscountForm">
      <fieldset>

        <div class="column small-12 medium-4">
          <label for="discount-type">Type</label>
          <select id="discount-type" ng-model="newDiscount.type" ng-blur="validateNewDiscount()">
            <option value="percentage">Percentage</option>
            <option value="value">Value</option>
          </select>
        </div>

        <div class="column small-12 medium-4">
          <div ng-show="newDiscount.type === 'percentage'">
            <label for="discount-percentage">Percentage</label>
            <input id="discount-percentage" type="number" min="0" max="100" ng-model="newDiscount.percentage" ng-blur="validateNewDiscount()" placeholder="0-100...">
          </div>
          <div ng-show="newDiscount.type === 'value'">
            <label for="discount-value">Value</label>
            <input id="discount-value" type="number" ng-model="newDiscount.value" ng-blur="validateNewDiscount()" placeholder="USD...">
          </div>
        </div>

        <div class="column small-12 medium-4">
          <label for="discount-code">Code</label>
          <input id="discount-code" type="text" ng-model="newDiscount.code" placeholder="Code...">
        </div>

        <div class="column small-12 medium-4">
          <label for="discount-expiration">Expiration</label>
          <input id="discount-expiration" type="date" ng-model="newDiscount.expiration" ng-blur="validateNewDiscount()">
        </div>

        <div class="column small-12 medium-4">
          <label for="discount-uses">Uses</label>
          <input id="discount-uses" type="number" min="1" ng-model="newDiscount.uses" ng-blur="validateNewDiscount()">
        </div>

        <div class="column small-12 medium-4">
          <label for="discount-product-slug">Product Slug</label>
          <input id="discount-product-slug" type="text" ng-model="newDiscount.productSlug" ng-blur="validateNewDiscount()" placeholder="Product slug...">
        </div>

        <div class="column small-12 medium-4">
          <label for="discount-min-subtotal">Min Subtotal</label>
          <input id="discount-min-subtotal" type="number" min="0" ng-model="newDiscount.minSubtotal" ng-blur="validateNewDiscount()" placeholder="Min subtotal...">
        </div>

        <div class="column small-12 medium-4">
          <label for="discount-max-subtotal">Max Subtotal</label>
          <input id="discount-max-subtotal" type="number" min="0" ng-model="newDiscount.maxSubtotal" ng-blur="validateNewDiscount()" placeholder="Max subtotal...">
        </div>

        <div class="column small-12 medium-4 padding-vertical-x-medium">
          <label class="left" for="discount-free-shipping">Free Shipping</label>
          <input id="discount-free-shipping" class="margin-horizontal-small-important" type="checkbox" ng-model="newDiscount.freeShipping" ng-blur="validateNewDiscount()">
        </div>

        <div class="column small-12">
          <button ng-click="createDiscount(newDiscount)" ng-disabled="newDiscountForm.$invalid" qv-focus="#discount-type">Create</button>
        </div>


      </fieldset>

    </form>

    <hr ng-show="discounts.length">

    <input type="text" ng-show="discounts.length" ng-model="discountFilter" ng-focus="discountFilter = ''" placeholder="Search..."/>
    <table class="small-12" ng-show="discounts.length" ng-class="{disabled: !firebaseLoaded}">
        <thead>
            <tr>
                <th>Active</th><th>Type</th><th>Value</th><th>Code</th><th>Expiration</th><th>Uses</th><th>Used</th><th>Product Slug</th><th>Min</th><th>Max</th><th>Free Shipping</th><th>Created</th><th class="text-center">Action</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="discount in discounts | filter:discountFilter | orderBy:'created':'desc'" ng-class="{disabled: disabled}">
                <td>
                  <input class="margin-zero-important" type="checkbox" ng-model="discount.active"/>
                </td>
                <td>
                  {{ ::discount.type }}
                </td>
                <td>
                  <span ng-show="discount.type === 'percentage'">{{ ::discount.percentage }}%</span>
                  <span ng-show="discount.type === 'value'">{{ ::discount.value | currency }}</span>
                </td>
                <td>
                  {{ ::discount.code }}
                </td>
                <td>
                  {{ ::discount.expiration | moment:"MM/DD/YY" }}
                </td>
                <td>
                  {{ ::discount.uses }}
                </td>
                <td>
                  {{ ::discount.useCount || 0 }}
                </td>
                <td>
                  {{ ::discount.productSlug  }}
                </td>
                <td>
                  {{ ::discount.minSubtotal }}
                </td>
                <td>
                  {{ ::discount.maxSubtotal }}
                </td>
                <td>
                  {{ ::discount.freeShipping }}
                </td>
                <td>
                  {{ ::discount.created | moment:"MM/DD/YY" }}
                </td>
                <td>
                  <button class="alert tiny margin-vertical-zero centered-block" style="min-width: 8rem;" qv-confirm="disabled = true; removeDiscount(discount);" ng-disabled="disabled">Delete</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>
